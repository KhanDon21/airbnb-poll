<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>Airbnb Poll</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .poll-item { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; }
    .poll-item h3 { margin-top: 0; }
    button { background-color: #007bff; color: white; padding: 8px 15px; border: none; cursor: pointer; }
    button:hover { opacity: 0.8; }
    .listing-link { margin-top: 5px; display: block; } /* Style for the link */
  </style>
</head>
<body>
  <h1>Which Airbnb do you prefer?</h1>
  <p>Click an Airbnb link to open it, or press the Vote button to register your pick. Results update live.</p>
  <div id="poll-container"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      google.script.run.withSuccessHandler(displayPollOptions).getPollOptions();
    });

    function displayPollOptions(options) {
      const container = document.getElementById('poll-container');
      container.innerHTML = ''; // Clear previous content

      options.forEach(option => {
        const itemName = option;   // Column A
        const price = option;      // Column B
        const listingUrl = option; // Column C - The link!
        const votes = option;      // Column D - Not displayed in original image, but available

        const div = document.createElement('div');
        div.className = 'poll-item';
        div.innerHTML = `
          <h3>${itemName} - ${price}</h3>
          <a href="${listingUrl}" target="_blank" class="listing-link">Open listing</a>
          <button onclick="voteFor('${itemName}')">Vote</button>
        `;
        container.appendChild(div);
      });
    }

    function voteFor(itemName) {
      google.script.run.withSuccessHandler(displayPollOptions).recordVote(itemName);
    }
  </script>
</body>
</html>


